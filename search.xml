<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Accurate Esophageal Gross Tumor Volume Segmentation in PET/CT using Two-Stream Chained 3D Deep Network Fusion</title>
    <url>/2022/09/25/Accurate-Esophageal-Gross-Tumor-Volume-Segmentation-in-PET-CT-using-Two-Stream-Chained-3D-Deep-Network-Fusion/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/633033af16f2c2beb18343a3.png"></p>
<p>论文链接：<a href="https://arxiv.org/abs/1909.01524">https://arxiv.org/abs/1909.01524</a></p>
<p>GitHub链接：</p>
<p>本地链接：<span id="more"></span></p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li>目标是利用RTCT和正电子发射断层扫描(PET)成像模式，以促进更精确的GTV分割。</li>
<li>提出了一种双流链分割方法，通过早期和晚期基于3D深度网络的融合有效地融合CT和PET模式。它将来自两个独立子网络的预测结合和合并，一个只使用RTCT训练，另一个同时使用RTCT和注册PET图像训练。前者利用CT的解剖背景信息，而后者则利用PET的敏感，但有时虚假和强大的对比。</li>
<li>为了实现融合和分割，我们提出了一个简单而有效的递进语义嵌套网络(PSNN)模型，其性能优于更复杂的模型。</li>
</ol>
<h2 id="Method："><a href="#Method：" class="headerlink" title="Method："></a>Method：</h2><p><img src="https://pic.imgdb.cn/item/6330526016f2c2beb1ab78d6.png"></p>
<ol>
<li><p>PET to RTCT Registration</p>
<ol>
<li>为了生成对齐的PET&#x2F;RTCT对，我们将基于三次b样条的变形配准算法应用于由粗到细的多尺度变形过程中。因为它具有良好的形状建模能力和捕获局部非刚体运动的效率。</li>
<li>我们使用两次CT扫描的肺肿块中心作为初始匹配位置。</li>
<li>我们从P-HNN模型产生的掩码中计算质量中心，即使在严重的病理病例中，它也能稳健地分割肺场。</li>
<li>这将为胸部和上腹部区域提供可靠的初始匹配，有助于成功register。然后将产生的变形场应用于诊断PET，使其在规划阶段与RTCT对齐。</li>
</ol>
</li>
<li><p>Two-Stream Chained Deep Fusion</p>
<ol>
<li>目标是有效地利用PET和CT成像空间中的互补信息。</li>
</ol>
</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/633055ed16f2c2beb1afc394.png"></p>
<p><img src="https://pic.imgdb.cn/item/6330562816f2c2beb1b008a3.png"></p>
<ol start="3">
<li>PSNN Model<ol>
<li>一种结合P-HNN和UNet优势的自然而简单的方法是使用与P-HNN本质上相同的参数块，但反转深度监督路径的方向，以允许高级信息传播到较低级别空间。我们将这种方法称为递进语义嵌套网络(PSNN)。</li>
</ol>
</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/6330573616f2c2beb1b14bad.png"></p>
<h2 id="Results："><a href="#Results：" class="headerlink" title="Results："></a>Results：</h2><ol>
<li>我们使用110名食管癌患者的数据集对我们的方法进行了广泛的评估，这些患者均诊断为II期或以上，并正在接受放疗。每个患者都有一个诊断PET&#x2F;CT对和一个治疗RTCT扫描。</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/6330578a16f2c2beb1b1b11a.png"></p>
<ol start="2">
<li>性能最好的结果是PSNN模型结合链式EF+LF，表明系统的每个组件都对我们的最终性能有贡献。</li>
</ol>
<h2 id="优点和借鉴："><a href="#优点和借鉴：" class="headerlink" title="优点和借鉴："></a>优点和借鉴：</h2><ol>
<li>提出并验证了一种使用RTCT和PET+RTCT成像通道的双流链式3D深度网络融合管道，用于分割食道gtv。诊断性PET和RTCT首先通过基于语义的肺质量中心初始化进行纵向注册，以实现鲁棒性。</li>
<li>使用Eq.(2)的EF训练的所有三个网络都比仅使用RTCT训练的网络产生更准确的分割结果。这验证了利用PET补充RTCT对GTV分割的有效性</li>
<li>PSNN模型比最先进的P-HNN和DenseUNet网络的性能要好。</li>
</ol>
]]></content>
      <tags>
        <tag>EC</tag>
        <tag>PET_CT</tag>
      </tags>
  </entry>
  <entry>
    <title>EC_POAF_dataset</title>
    <url>/2022/07/10/EC-POAF-dataset/</url>
    <content><![CDATA[<h1 id="Meta-analysis-of-risk-factors-and-complications-associated-with-atrial-fibrillation-after-oesophagectomy"><a href="#Meta-analysis-of-risk-factors-and-complications-associated-with-atrial-fibrillation-after-oesophagectomy" class="headerlink" title="Meta-analysis of risk factors and complications associated with atrial fibrillation after oesophagectomy"></a>Meta-analysis of risk factors and complications associated with atrial fibrillation after oesophagectomy</h1><p><img src="https://s2.loli.net/2022/07/10/y3Uph1TgeVKfASD.png" alt="Snipaste_2022-07-10_20-16-27.png"></p>
<p><a href="https://academic.oup.com/bjs/article/106/5/534/6092842?login=true#supplementary-data">https://academic.oup.com/bjs/article/106/5/534/6092842?login=true#supplementary-data</a> <span id="more"></span></p>
<p>In total, 53 studies including 9087 patients were eligible for analysis. The overall incidence of postoperative AF was 16⋅5 per cent. Coronary artery disease and hypertension were associated with AF , whereas diabetes, smoking and chronic obstructive pulmonary disease were not. Patients with AF had a significantly higher risk of overall postoperative adverse events than those without fibrillation (odds ratio (OR) 5⋅50, 95 per cent c.i. 3⋅51 to 8⋅30), including 30-day mortality (OR 2⋅49, 1⋅70 to 3⋅64), anastomotic leak (OR 2⋅65, 1⋅53 to 4⋅59) and pneumonia (OR 3⋅42, 2⋅39 to 4⋅90).</p>
<h2 id="Risk-factors-of-atrial-fibrillation-occurring-after-radical-surgery-of-esophageal-carcinoma"><a href="#Risk-factors-of-atrial-fibrillation-occurring-after-radical-surgery-of-esophageal-carcinoma" class="headerlink" title="Risk factors of atrial fibrillation occurring after radical surgery of esophageal carcinoma"></a>Risk factors of atrial fibrillation occurring after radical surgery of esophageal carcinoma</h2><p><img src="https://s2.loli.net/2022/07/10/gNQ35R29eCtvqMj.png" alt="Snipaste_2022-07-10_20-20-32.png"></p>
<p><a href="https://cardiothoracicsurgery.biomedcentral.com/articles/10.1186/s13019-019-0885-z">Risk factors of atrial fibrillation occurring after radical surgery of esophageal carcinoma | Journal of Cardiothoracic Surgery | Full Text (biomedcentral.com)</a></p>
<p>Ji-bin Lu,  Correspondence: <a href="mailto:&#121;&#x75;&#x6e;&#101;&#x72;&#x33;&#48;&#50;&#49;&#64;&#115;&#105;&#x6e;&#97;&#46;&#x63;&#x6f;&#x6d;">&#121;&#x75;&#x6e;&#101;&#x72;&#x33;&#48;&#50;&#49;&#64;&#115;&#105;&#x6e;&#97;&#46;&#x63;&#x6f;&#x6d;</a></p>
<p>Of the 335 patients with esophageal cancer, 48 had AF within one week after operation. Univariate analysis indicated that the age (OR: 4 . 8 9 ; CI: 2 . 5 3–9.47, P: 0.000), gender (OR: 2 . 2 6 ; CI: 1 . 1 7–4.37, P: 0.013), history of peripheral vascular disease (OR: 2 . 2 9 ; CI: 1 . 0 6–4.92, P: 0.030), history of cardiac stents or angina pectoris (OR: 2 7 . 3 0 ; CI: 1 2 . 4 4–59.91, P: 0.000), preoperative BNP level (OR: 2 7 . 1 3 ; CI: 1 0 . 9 7–67.06, P: 0.000), preoperative left ventricular diastolic dysfunction (OR: 2 . 2 2 ; CI: 1 . 1 9–4.14, P: 0.012), operative method (OR: 2 . 0 9 ; CI: 1 . 0 0 2–4.380, P: 0.046), intraoperative blood transfusion (OR: 2 0 . 2 4 ; CI: 8 . 3 9–48.82, P: 0.000), and adhesion between lymph nodes and pericardium were risk factors (OR: 2 . 0 5 ; CI: 1 . 0 8–3.87, P: 0.024). Furthermore, multivariate analysis displayed that advanced age (OR: 5 . 0 4 4 ; CI: 1 . 7 4 8–14.554, P: 0 . 003), male (OR: 6 . 1 6 1 ; CI: 2 . 1 4 3–17 .715, P: 0.001), history of cardiac stents or angina pectoris (OR: 48.813; CI: 1 3 . 6 7 4–174. 246, P: 0.000), preoperative BNP &gt; 100 (OR: 41.515; CI: 9 . 3 8 0–183.732, P: 0.000), open surgery (OR: 3 . 3 5 7 ; CI: 1 . 0 2 6–10.983, P: 0.045), intraoperative blood transfusion (OR: 58.404; CI: 1 0 . 7 7 7–316.509, P: 0.000), and adhesion between lymph nodes and pericardium (OR: 3 . 9 5 4 ; CI: 1 . 3 6 4–11.459, P: 0.011) were risk factors which could increase the incidence of postoperative AF.</p>
<p><img src="https://s2.loli.net/2022/07/10/mj8iIfYDvhFB5Xn.png" alt="Snipaste_2022-07-10_20-24-40.png"></p>
<h2 id="Age-and-neo-adjuvant-chemotherapy-increase-the-risk-of-atrial-fibrillation-following-oesophagectomy"><a href="#Age-and-neo-adjuvant-chemotherapy-increase-the-risk-of-atrial-fibrillation-following-oesophagectomy" class="headerlink" title="Age and neo-adjuvant chemotherapy increase the risk of atrial fibrillation following oesophagectomy"></a>Age and neo-adjuvant chemotherapy increase the risk of atrial fibrillation following oesophagectomy</h2><p><img src="https://s2.loli.net/2022/07/10/EHX2qfesOkwQ6Ib.png" alt="Snipaste_2022-07-10_20-19-13.png"></p>
<p><a href="https://academic.oup.com/ejcts/article/42/3/438/404705?login=true">https://academic.oup.com/ejcts/article/42/3/438/404705?login=true</a></p>
<p>Vinay P. Rao,  e-mail: <a href="mailto:&#x76;&#x69;&#110;&#x61;&#x79;&#x70;&#x72;&#x61;&#111;&#64;&#x68;&#x6f;&#x74;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#109;">&#x76;&#x69;&#110;&#x61;&#x79;&#x70;&#x72;&#x61;&#111;&#64;&#x68;&#x6f;&#x74;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#109;</a> (V.P. Rao).</p>
<p>Data were extracted from a database of patients who underwent oesophagectomy between 1991 and 2009. Patients with pre-operative arrhythmias were excluded leaving 997 patients for further analysis. Univariate and multivariate logistic regression analyses were performed to identify factors predicting AF, and receiver operating characteristic curves were generated from a model using these predictors. Statistical significance was reflected in a P-value of &lt;0.05.</p>
<p>Despite the identification of age and neo-adjuvant chemotherapy as predictors of AF, the moderate discriminative ability of predictive modelling does not support the use of prophylactic anti-arrhythmic drugs. However, the high incidence of AF after major thoracic surgery makes it necessary to understand its underlying mechanisms better before prophylactic strategies are considered.</p>
<p><img src="https://s2.loli.net/2022/07/10/jULeqz3C9yOoBPI.png" alt="Snipaste_2022-07-10_20-18-16.png"></p>
<h2 id="The-predictive-value-of-new-onset-atrial-fibrillation-on-postoperative-morbidity-after-esophagectomy"><a href="#The-predictive-value-of-new-onset-atrial-fibrillation-on-postoperative-morbidity-after-esophagectomy" class="headerlink" title="The predictive value of new-onset atrial fibrillation on postoperative morbidity after esophagectomy"></a>The predictive value of new-onset atrial fibrillation on postoperative morbidity after esophagectomy</h2><p><img src="https://s2.loli.net/2022/07/10/tzD1BNoElLin3sd.png" alt="Snipaste_2022-07-10_20-36-14.png"></p>
<p>M. F . J . Seesing, <a href="mailto:&#x6a;&#46;&#x70;&#x2e;&#114;&#x75;&#117;&#114;&#x64;&#97;&#64;&#117;&#109;&#99;&#x75;&#116;&#x72;&#101;&#x63;&#104;&#x74;&#46;&#x6e;&#108;">&#x6a;&#46;&#x70;&#x2e;&#114;&#x75;&#117;&#114;&#x64;&#97;&#64;&#117;&#109;&#99;&#x75;&#116;&#x72;&#101;&#x63;&#104;&#x74;&#46;&#x6e;&#108;</a></p>
<p><a href="https://academic.oup.com/dote/article/31/11/doy028/4959875?login=true">https://academic.oup.com/dote/article/31/11/doy028/4959875?login=true</a></p>
<p>SUMMARY. New-onset atrial fibrillation (AF) is frequently observed following esophagectomy and may predict other complications. The aim of the current study was to determine the association between, and the possible predictive value of, new-onset AF and infectious complications following esophagectomy . Consecutive patients who underwent elective esophagectomy with curative intent for esophageal cancer between 2004 and 2016 in the University Medical Center Utrecht were included from a prospective database. The date of diagnosis of the complications included in the current analysis was retrospectively collected from the computerized medical record. The association between new-onset AF and infectious complications was studied in univariable and multivariable logistic regression analyses. A total of 455 patients were included. In 93 (20.4%) patients new-onset AF was encountered after esophagectomy . There were no significant differences in patient and treatment-related characteristics between the patients with and without AF. In 9 (9.7%) patients, AF was the only adverse event following surgery . In multivariable analyses, AF was significantly associated with infectious complications in general (OR 3.00, 95% CI: 1.73–5.21). More specifically, AF was associated with pulmonary complications (OR 2.06, 95% CI: 1.29–3.30), pneumonia (OR 2.41, 95% CI: 1.48–3.91) and anastomotic leakage (OR 3.00, 95% CI: 1.80–4.99). In patients who underwent esophagectomy, new-onset AF was highly associated with infectious complications. AF may serve as an early clinical warning sign for anastomotic leakage. Therefore, further evaluation of patients who develop new-onset AF after esophagectomy is warranted.</p>
<p>Consecutive patients who underwent an elective esophagectomy for esophageal or gastroesophageal junction cancer with curative intent between 2004 and 2016 at the University Medical Center (UMC) Utrecht were included in this study . Exclusion criteria included preoperative presence of AF and American Association of Anaesthesiologists (ASA) IV classification. Patients included in this study were not given routine AF prophylaxis postoperatively . Patient and treatment-related characteristics as well as surgical outcome data were prospectively recorded in an Institutional Review Board (IRB) approved database. The date of diagnosis of the complications included in the current analysis was retrospectively collected from the computerized medical record. Creactive protein (CRP) levels were registered at the day of AF diagnosis. This study was approved by the Medical Ethics Review Committee of the UMC Utrecht (IRB-number 13–061&#x2F;C), and informed consent was waived.</p>
<h2 id="Association-between-Postoperatively-Developed-Atrial-Fibrillation-and-Long-Term-Mortality-after-Esophagectomy-in-Esophageal-Cancer-Patients-An-Observational-Study"><a href="#Association-between-Postoperatively-Developed-Atrial-Fibrillation-and-Long-Term-Mortality-after-Esophagectomy-in-Esophageal-Cancer-Patients-An-Observational-Study" class="headerlink" title="Association between Postoperatively Developed Atrial Fibrillation and Long-Term Mortality after Esophagectomy in Esophageal Cancer Patients: An Observational Study"></a>Association between Postoperatively Developed Atrial Fibrillation and Long-Term Mortality after Esophagectomy in Esophageal Cancer Patients: An Observational Study</h2><p><img src="https://s2.loli.net/2022/07/10/k19OlGC85zScyhf.png" alt="Snipaste_2022-07-10_20-47-55.png"></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/27148877/">https://pubmed.ncbi.nlm.nih.gov/27148877/</a></p>
<p>This study evaluated 583 patients undergoing esophagectomy, from January 2005 to April 2012. AF was defined as newly developed postoperative AF requiring treatment. The risk factors for AF and the association between AF and mortality were evaluated. The long-term mortality was the all-cause mortality, for which the cutoff date was May 31, 2014.v</p>
<p>This retrospective cohort study examined 598 consecutive patients who underwent esophagectomy due to esophageal cancer at Asan Medical Center, Seoul, South Korea, from January 2005 to April 2012. Patients with AF, atrial flutter, paced rhythm on preoperative electrocardiogram, and history of AF were excluded. The research protocol was approved and the requirement of written informed consent was waived by our Institutional Review Board (AMC IRB 2013– 0959). </p>
<p>The patient data were obtained through the review of electronic medical records. The clinical data included age, gender, body mass index (BMI) (kg&#x2F;m2), preoperative electrocardiogram, preoperative resting heart rate (HR), diabetes mellitus (DM), hypertension, ischemic heart disease (IHD), cerebrovascular disease, peripheral vascular disease (PVD), chronic kidney disease (serum creatinine &gt; 1.5 mg&#x2F;dl or estimated glomerular filtration rate &lt; 60 ml&#x2F;min&#x2F;1.73 m2), liver disease, history of neoadjuvant chemoradiation therapy, classification of the American Society of Anesthesiologist physical status, preoperative hematocrit, left ventricular ejection fraction, predicted forced vital capacity (FVC), predicted forced expiratory volume in one second (FEV1), FEV1&#x2F;FVC ratio, duration of surgery, and infused fluid volume during surgery. The data regarding the preoperative use of angiotensin-converting enzyme inhibitor (ACEI) or angiotensin receptor blocker (ARB), β-blocker, calcium channel blocker (CCB), insulin, oral hypoglycemic agents, lipid-lowering drugs, aspirin, and diuretics were acquired. The pathologic stage of the esophageal cancer was determined using the TNM classification of the 7th edition of the American Joint Committee on Cancer. The type of surgical approach was divided into two-stage, three-stage, and transhiatal esophagectomy. The data regarding the postoperative outcomes included pneumonia (diagnosed with radiographic evidence of pneumonia) [14], acute kidney injury, hospital stay, in-hospital mortality (mortality during hospital stay or within 30 days after surgery), 1-year mortality, and long-term mortality. Acute kidney injury (AKI) was classified according to the Acute Kidney Injury Network (AKIN) criteria for changes in the level of serum creatinine within 48 hours of surgery [15]. The long-term mortality was the all-cause mortality, for which the cutoff date was May 31, 2014. </p>
<p>AF was defined as newly developed AF after esophagectomy prior to discharge that required therapy irrespective of the AF duration. AF was reviewed during the postoperative period, or from the patient arrival at the intensive care unit after surgery until discharge. The rhythm was monitored continuously with lead II and V5 electrocardiogram in the intensive care unit. In the general ward, the electrocardiogram was checked once a day routinely and when the patients experienced newly developed symptoms, such as palpitation or dizziness, or when the physical examination disclosed an irregular rhythm. Electrical cardioversion or amiodarone administration (300 mg of intravenous bolus administration followed by 1500 mg&#x2F;day for 24 hours) was performed to restore the sinus rhythm.</p>
<p><img src="https://s2.loli.net/2022/07/10/xKjZtymBNgXCvsD.png" alt="Snipaste_2022-07-10_20-52-40.png"></p>
]]></content>
      <categories>
        <category>POAF_EC</category>
      </categories>
      <tags>
        <tag>POAF_EC</tag>
        <tag>data</tag>
      </tags>
  </entry>
  <entry>
    <title>DynNom: Visualising statistical models using dynamic nomograms</title>
    <url>/2022/09/11/DynNom-Visualising-statistical-models-using-dynamic-nomograms/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/631d9ef816f2c2beb11a25ef.png"></p>
<p>文章链接：<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0225253">Visualising statistical models using dynamic nomograms | PLOS ONE</a></p>
<p>GitHub链接：</p>
<p>本地链接：C:\Users\junglingfish\Zotero\storage\DFF3R3PG<span id="more"></span></p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li><p>提出使用动态nomogram作为平移工具，它可以适应越来越复杂的模型。</p>
</li>
<li><p>文献中出现的所有模型都可以配以相应的动态nomogram来进行模型的信息转换。提出的R包将促进各种线性和非线性模型的这种通信。</p>
</li>
</ol>
<h2 id="Methods-amp-Results："><a href="#Methods-amp-Results：" class="headerlink" title="Methods &amp; Results："></a>Methods &amp; Results：</h2><ol>
<li>构建DynNom包[32]的目的是为各种统计模型生成动态的nomogram，使读者能够以用户友好的方式与模型进行交互。</li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">R<span class="operator">&gt;</span> fit <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>survived <span class="operator">~</span> <span class="punctuation">(</span>age <span class="operator">+</span> pclass <span class="operator">+</span> sex<span class="punctuation">)</span> <span class="operator">^</span> <span class="number">3</span><span class="punctuation">,</span> titanic3<span class="punctuation">,</span> family <span class="operator">=</span> “binomial”<span class="punctuation">)</span></span><br><span class="line">R<span class="operator">&gt;</span> DynNom<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p><img src="https://pic.imgdb.cn/item/631da07416f2c2beb11bb54c.png"></p>
<p><img src="https://pic.imgdb.cn/item/631da09816f2c2beb11bdd48.png"></p>
<ol start="2">
<li>该包的两个主要功能是DynNom和DNbuilder函数。前者从拟合模型中提取模型类，构建一个动态的nomogram应用程序，使用Eq 2计算并显示点和区间估计，而后者生成部署应用程序所需的文件。</li>
<li>DynNom包支持R.中的lm、glm和coxph函数创建的模型对象。它还支持rms包中的ols、glm、lrm和cph模型，rms包允许包含平滑样条以及来自mgcv和的gam函数。</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/631da10016f2c2beb11c4180.png"></p>
<h2 id="优点与借鉴"><a href="#优点与借鉴" class="headerlink" title="优点与借鉴"></a>优点与借鉴</h2><ol>
<li>可交互的Nomogram，实用性远远大于普通的Nomogram以及其余的一些动态的Nomogram，可以在临床上的风险预测模型等上进行应用。</li>
<li>适用于绝大多数流行的临床模型，在很多方面都可以适配的很好，应用较为方便。</li>
<li>将模型摘要与相应的动态图链接在期刊上，有可能使模型更可翻译，并在实现所有研究都可理解和可重现的建议方面使分析更透明。</li>
</ol>
]]></content>
      <categories>
        <category>POAF</category>
      </categories>
      <tags>
        <tag>POAF</tag>
        <tag>R</tag>
      </tags>
  </entry>
  <entry>
    <title>Incidence, predictors, and outcome for post-operative atrial fibrillation in Indian patients undergoing off-pump coronary artery bypass grafting-a prospective observational study</title>
    <url>/2022/09/13/Incidence-predictors-and-outcome-for-post-operative-atrial-fibrillation-in-Indian-patients-undergoing-off-pump-coronary-artery-bypass-grafting-a-prospective-observational-study/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/6320630816f2c2beb19843cc.png"></p>
<p>论文链接：<a href="https://pubmed.ncbi.nlm.nih.gov/35756560/">Incidence, predictors, and outcome for post-operative atrial fibrillation in Indian patients undergoing off-pump coronary artery bypass grafting-a prospective observational study - PubMed (nih.gov)</a></p>
<p>本地文件链接：C:\Users\junglingfish\Zotero\storage\2KYJHLNF <span id="more"></span></p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary:"></a>Summary:</h2><ol>
<li>The aim of this study was to assess the incidence of POAF, measure its impact on outcomes, and identify the predictors for POAF in the Indian patients undergoing OPCAB. Besides, the ability of European System for Cardiac Operative Risk Evaluation (EuroSCORE) and Society of Thoracic Surgeons (STS) scores in predicting POAF was also assessed.</li>
<li>We recruited 1108 patients in the study.</li>
<li>Age (OR &#x3D; 1.082, p &lt;0.001 , 95%CI: 1.050–1.114), unstable angina (OR &#x3D; 16.32, p &#x3D; 0 . 0 3 6 , 9 5 % C I : 1 . 2–221.4), presence of diabetes mellitus (OR 1.781, p &#x3D; 0.025, 95%CI: 1.074–2.955), left atrial size (OR 2.506, p &#x3D; 0.001, 95%CI: 1.478–4.251), and presence of chronic renal failure (OR 8.7, p &#x3D; 0.001, 95%CI: 2.4–31.53) were significant predictors of POAF.</li>
<li>In our study, the incidence of POAF was much lower (7.94%) than that reported previously. POAF significantly increased adverse outcomes and length of hospital stay. Both EuroSCORE II and STS scores had similar discriminating power in predicting POAF.</li>
</ol>
<h2 id="Methods"><a href="#Methods" class="headerlink" title="Methods:"></a>Methods:</h2><p><img src="https://pic.imgdb.cn/item/632064f916f2c2beb19af933.png"></p>
]]></content>
      <categories>
        <category>POAF</category>
      </categories>
      <tags>
        <tag>POAF</tag>
      </tags>
  </entry>
  <entry>
    <title>Multi-institutional Validation of Two-Streamed Deep Learning Method for Automated Delineation of Esophageal Gross Tumor Volume Using planning-CT and FDG-PET/CT</title>
    <url>/2022/09/26/Multi-institutional-Validation-of-Two-Streamed-Deep-Learning-Method-for-Automated-Delineation-of-Esophageal-Gross-Tumor-Volume-Using-planning-CT-and-FDG-PET-CT/</url>
    <content><![CDATA[<p><img src="https://pic1.imgdb.cn/item/6331988f16f2c2beb1e39c85.png"></p>
<p>论文链接：[<a href="https://arxiv.org/abs/2110.05280">2110.05280] Multi-institutional Validation of Two-Streamed Deep Learning Method for Automated Delineation of Esophageal Gross Tumor Volume using planning-CT and FDG-PETCT (arxiv.org)</a></p>
<p>GitHub链接：</p>
<p>本地链接：<span id="more"></span></p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li>为了验证深度学习多模态食管GTV轮廓模型的临床适用性。</li>
<li>两流深度模型在内部测试中获得了较高的分割精度(CT时Dice评分为0.81,CT+PET时为0.83)，对外部评估具有良好的泛化能力(CT时Dice评分为0.80)。</li>
<li>在多用户评价中，在深度模型的辅助下，观察者间变化和所需轮廓时间分别减少了37.6%和48.0%。</li>
</ol>
<h2 id="Methods："><a href="#Methods：" class="headerlink" title="Methods："></a>Methods：</h2><p><img src="https://pic1.imgdb.cn/item/63319aac16f2c2beb1e5d482.png"></p>
<ol>
<li>Datasets<ol>
<li>来自4个机构的606例食管癌患者，根据PET扫描仪的可用性和不同机构的分期方案，来自机构-1的患者(共252例)接受了额外的诊断性FDGPET&#x2F;CT扫描，而来自其他机构的354例患者仅接受了pCT扫描。</li>
</ol>
</li>
</ol>
<p><img src="https://pic1.imgdb.cn/item/63319caa16f2c2beb1e7e9dd.png"></p>
<p><img src="https://pic1.imgdb.cn/item/63319ed216f2c2beb1ea25b2.png"></p>
<ol start="2">
<li>Model development <ol>
<li>我们实现了一种双流三维食道GTV分割方法，其中包括一个pCT流，只使用pCT输入来分割GTV(表示pCT模型)，以及一个使用早期融合模块的pCT+PET流，以及一个使用后期融合模块的pCT+PET流，利用pCT和PET多模态中的联合信息来分割GTV(表示pCT+PET模型)。</li>
<li>在pCT+PET流中，PET与pCT对齐，首先将诊断CT(伴随PET)注册到pCT，然后利用变形场将PET映射到pCT，分割骨干采用3D渐进语义嵌套网络。</li>
</ol>
</li>
<li>Quantitative Evaluation of Contour Accuracy <ol>
<li>使用三种常见的分割指标(9,10)定量评估轮廓精度，即骰子相似系数(DSC)、95% Hausdorff距离(HD95)和平均表面距离(ASD)。</li>
<li>在外部测试中，报告了pCT模型的性能。我们还探讨了这些指标在不同特征亚组中的比较:临床t分期和不同肿瘤位置(颈部、食管上、中、下三分之一)。</li>
</ol>
</li>
<li>Human Experts’ Assessment of Contour Accuracy <ol>
<li>进一步由人类专家进行评估实验，以评估临床接受深度模型预测所需的轮廓编辑工作。专家评估预测结果需要手工修改的程度。</li>
</ol>
</li>
<li>Multi-user Evaluation  <ol>
<li>进一步开展了一项多用户研究，涉及4个不同机构的4名经委员会认证的放射肿瘤学家(3-6年食管癌治疗经验)。</li>
<li>我们的深度模型预测的准确性与DSC、HD95和ASD方面的多用户性能进行了比较。</li>
</ol>
</li>
<li>Statistical Analysis <ol>
<li>采用Wilcoxon配对符号秩检验比较<ol>
<li>pCT模型与pCT+PET模型在内部检验集中的DSC、HD95和ASD评分;在外部测试集中，提出的模型与3D DenseUNet方法之间存在差异;</li>
<li>DSC、HD95、ASD和深度学习辅助轮廓绘制前后在多用户9评估中的时间。</li>
</ol>
</li>
<li>采用Manning-Whitney U检验比较DSC、HD95和ASD在不同临床t分期的差异。</li>
<li>采用多元线性回归逐步模型选择来比较不同肿瘤位置的指标，因为一个大肿瘤可能位于多个食道区域。</li>
<li>分别评估平均DSC、HD95和ASD与人工修改程度的Spearman相关系数。</li>
</ol>
</li>
</ol>
<h2 id="Result："><a href="#Result：" class="headerlink" title="Result："></a>Result：</h2><ol>
<li>内部验证结果&amp;外部验证结果 优秀，在其DSC、HD95和ASD评分均优于之前领先的3D DenseUNet。</li>
<li>专家的评估显示，DSC、HD95和ASD作为轮廓精度评价标准的可靠性，与临床实际需要的轮廓编辑工作相一致。33例(9%)患者预测结果不可接受，我们的模型未能准确定位肿瘤，导致骰子小，距离误差大。</li>
<li>Multi-user evaluation中，在20个测试案例中，我们的模型在DSC和ASD方面与这四位放射肿瘤学家的表现相当。</li>
<li>我们的pCT模型平均需要20秒来预测一个病人。</li>
</ol>
<h2 id="优点和借鉴"><a href="#优点和借鉴" class="headerlink" title="优点和借鉴"></a>优点和借鉴</h2><ol>
<li>我们开发了一个两流3D深度学习模型，多中心验证。其pCT模型在内部测试中实现了平均骰子相似系数(DSC)和平均表面距离(ASD)分别为0.81和2.7mm，在外部测试中推广效果良好，平均DSC和ASD分别为0.80和2.8mm。添加PET扫描后，pCT+PET模型进一步将DSC和ASD提高到0.83和2.2mm用于内部测试。通过允许放射肿瘤学家编辑深度模型预测，整体精度得到了提高，观察者间变异和轮廓时间分别减少了37.6%和48.0%。</li>
<li>临床实践中，深度模型可以通过提高轮廓绘制的准确性和一致性，并减少时间，使放射肿瘤学家受益。</li>
<li>我们的模型具有良好的可泛化性，可能来自以下几个方面:(1)不同机构的pCT相关标准化成像协议，尽管pCT扫描仪厂商不同;(2) CT中物理校正良好的HU值;(3)来自机构1的148名训练患者相对足够覆盖食道肿瘤的不同CT特征;(4)我们已经有效地训练了我们的双流深度GTV网络。</li>
<li>不足<ol>
<li>没有在外部验证集上验证pCT+PET模型的性能，因为外部数据集患者没有PET&#x2F;CT扫描的数据。</li>
<li>与临床晚期t期患者相比，cT2患者的pCT模型表现较差。</li>
<li>我们排除了胃食管交界处原发肿瘤的患者，因为他们在我们的研究人群中相对罕见(&lt; 2%)。</li>
</ol>
</li>
<li>借鉴意义<ol>
<li>双流模型，pCT pCT+PET，准确性</li>
<li>多中心，四个机构的数据集，泛化性好</li>
<li>专家验证加多用户验证，内部验证较为全面，确保模型的性能</li>
</ol>
</li>
</ol>
]]></content>
      <tags>
        <tag>EC</tag>
        <tag>PET_CT</tag>
      </tags>
  </entry>
  <entry>
    <title>Lymph Node Gross Tumor Volume Detection and Segmentation via Distance-based Gating using 3D CT/PET Imaging in Radiotherapy</title>
    <url>/2022/09/26/Lymph-Node-Gross-Tumor-Volume-Detection-and-Segmentation-via-Distance-based-Gating-using-3D-CT-PET-Imaging-in-Radiotherapy/</url>
    <content><![CDATA[<p><img src="https://pic1.imgdb.cn/item/6331a62d16f2c2beb1f2e289.png"></p>
<p>论文链接：<a href="https://arxiv.org/abs/2008.11870">https://arxiv.org/abs/2008.11870</a></p>
<p>GitHub链接：</p>
<p>本地链接：</p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li>提出了一种有效的基于距离的门控方法，以分而治之的方式模拟和简化由放射肿瘤学家进行的高级推理协议。</li>
<li>采用二元或软距离门控的方法将GTVLN分为“肿瘤近端”和“肿瘤远端”两个亚组。这是由于观察到每个类别在外观、大小和其他LN特征上都有不同但重叠的分布。</li>
<li>提出了一种新的多分支分割检测网络，每个分支专门学习一个GTVLN类别特征，并将多分支的输出融合到推理中。</li>
<li>与之前最先进的研究相比，我们的结果证实了平均召回率从72.5%显著提高到78.2%。最高的GTVLN召回率为82.5%，精确度为20%，这与临床相关且有价值，因为人类观察者的灵敏度往往较低(据文献报道，对于最有经验的放射肿瘤学家来说，灵敏度约为80%)</li>
</ol>
<h2 id="Methods："><a href="#Methods：" class="headerlink" title="Methods："></a>Methods：</h2><p><img src="https://pic1.imgdb.cn/item/6331aa3a16f2c2beb1f75cd2.png"></p>
<p>多分支GTVLN分割检测方法：</p>
<ol>
<li><p>首先计算三维肿瘤距离转换图，基于此将任何GTVLN分为肿瘤近端或肿瘤邻近子类别。</p>
<ol>
<li>先从原发肿瘤o计算三维肿瘤距离转换图，记为XD。每个体素xi处的值表示该体素与原发肿瘤掩膜之间的最短距离。设B(O)是包含肿瘤边界体素的集合。体素xi处的距离变换值计算为:(其中d(xi, q)是xi到q的欧氏距离。)</li>
</ol>
<p><img src="https://pic1.imgdb.cn/item/63396d3716f2c2beb119bdac.png"></p>
<p>​	</p>
</li>
<li><p>接下来，设计一个多分支按分割检测网络，其中每个分支集中于GTVLN分割的一个子组。通过在两个分支的输出处对惩罚函数施加一个二进制或软距离门控函数来实现的。</p>
<ol>
<li>将GTVLN分为肿瘤近端亚群和肿瘤远端亚群</li>
<li>每个分支由一个独立的解码器实现，以学习和提取子群的特定信息，而它们共享一个编码器来提取GTVLN的共同图像特征。</li>
</ol>
</li>
<li><p>每个分支都可以学习特定的参数，分别用于肿瘤-近端和肿瘤-邻端GTVLN的分割和检测。</p>
</li>
<li><p>Distance-based Gating Module</p>
<ol>
<li>Binary Distance Gating (BG). <ol>
<li>根据肿瘤距离图XD，我们将图像体素分为两组，xprox和xdis，分别为肿瘤近端和肿瘤远端，其中prox &#x3D; {i|xDi≤d0, xDi∈XD}， dis &#x3D; {i|xDi &gt; d0, xDi∈XD}。两个解码器的门控转换定义为Gprox &#x3D; 1[xDi≤d0]和Gdist &#x3D; 1−Gprox，其中1[·]是一个指示函数，当参数为真时为1，否则为零。</li>
<li>将GTVLN严格划分为两个互不关联的类别，每个分支专注于从一个类别中解码和学习。</li>
</ol>
</li>
<li>Soft Distance Gating (SG). <ol>
<li>我们进一步探索了一种软门控方法，该方法可以随着GTVLN样本距离肿瘤的远近线性改变其惩罚权重。这可以避免样本靠近近端和远端类别边界时权重值的突然变化。</li>
<li>Gdist &#x3D; 1−Gprox</li>
</ol>
</li>
</ol>
</li>
</ol>
<p><img src="https://pic1.imgdb.cn/item/633ec72616f2c2beb1258196.png"></p>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results:"></a>Results:</h2><ol>
<li>Datasets: 141例食管癌患者的无对比rtct + 所有患者均接受放疗治疗。放射肿瘤学家标记原发肿瘤和所有GTVLN的3D分割mask + 对于每个患者，我们都有一个非对比RTCT和一对PET&#x2F;CT扫描。在纵隔或上腹部区域共有651个带有体素注释的GTVLN数据集 + 60%、10%、30%分别进行培训、验证和测试</li>
<li>Results:<ol>
<li>多模态输入，即RTCT、PET和肿瘤距离图的早期融合(EF)对检测GTVLN有很大的好处。与单独使用RTCT相比，采用EF时mRecall和mFROC的性能有明显的绝对提高</li>
<li>基于距离的门控策略明显有效，Multi-net BG、多分支BG和多分支SG的选择一致提高了性能。</li>
<li>使用基于距离的门控策略，我们提出的多分支方法比Multi-net BG模型的性能要好得多。</li>
</ol>
</li>
</ol>
<p><img src="https://pic1.imgdb.cn/item/633ec82e16f2c2beb127634c.png"></p>
<p>​	</p>
<h2 id="优点与借鉴"><a href="#优点与借鉴" class="headerlink" title="优点与借鉴"></a>优点与借鉴</h2><ol>
<li>多模态输入，TCT、PET和肿瘤距离图的早期融合(EF)</li>
<li>基于距离的门控策略</li>
<li>多分支方法更为优秀</li>
</ol>
]]></content>
      <tags>
        <tag>EC</tag>
        <tag>PET_CT</tag>
      </tags>
  </entry>
  <entry>
    <title>Network-based machine learning approach to predict immunotherapy response in cancer patents</title>
    <url>/2022/09/09/Network-based-machine-learning-approach-to-predict-immunotherapy-response-in-cancer-patents/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/631d9df216f2c2beb11919da.png"></p>
<p>文章链接：<a href="https://www.nature.com/articles/s41467-022-31535-6">https://www.nature.com/articles/s41467-022-31535-6</a></p>
<p>源代码：<a href="https://github.com/SBIlab/NetBio">https://github.com/SBIlab/NetBio</a></p>
<p>本地文件位置：C:\Users\junglingfish\Zotero\storage\3H2GYTTM<span id="more"></span></p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary:"></a>Summary:</h2><ol>
<li>提出了一个机器学习(ML)框架，利用基于网络的分析来识别ICI治疗生物标志物(NetBio)，可以做出稳健的预测。</li>
<li>整理了700多例ICI治疗的患者样本，包括临床结果和转录组数据，并观察到基于netbio的预测准确预测了三种不同癌症类型的ICI治疗反应——黑色素瘤、胃癌和膀胱癌。</li>
<li>提出了一种基于网络的方法，以有效地选择免疫治疗反应相关的生物标志物，可以对精确的肿瘤进行基于ML的稳健预测</li>
</ol>
<h2 id="Method："><a href="#Method：" class="headerlink" title="Method："></a>Method：</h2><p><img src="https://pic.imgdb.cn/item/631d9e2516f2c2beb11953ae.png"></p>
<ol>
<li>我们使用STRING PPI网络(STRING score &gt;700)，包含16,957个节点和420,381条边。首先，采用网络传播，使用ICI靶标(例如，nivolumab的PD1或atezolizumab的PD-L1)作为种子基因，在网络上传播ICI靶标的影响。网络传播的一个特点是，越接近ICI目标的节点影响分数越高。接下来，我们选择了影响分数高的基因(top 200基因)，并鉴定了这些基因富集的生物通路(Reactome pathways)。然后，我们使用所选择的生物通路来预测免疫治疗反应，并将这些通路视为网络生物标记物(NetBio)。</li>
<li>为了进行基于ml的免疫治疗-反应预测，我们使用NetBio作为输入特征；作为阴性对照，我们使用了基于基因的生物标志物(即免疫治疗靶基因)、基于肿瘤微环境的生物标志物或从数据驱动的ML方法中选择的通路。</li>
<li>为了测试输入特征的预测性能，我们测量了在预测(i)通过免疫治疗后缩小肿瘤大小测量的药物反应或(ii)患者的survival方面的性能。</li>
<li>独立的训练集和测试集</li>
</ol>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><ol>
<li>研究内交叉验证表明，基于netbio的ML可以对ICI治疗反应和总生存期做出一致的预测。<ol>
<li>进行了留一交叉验证(LOOCV)，使用NetBio或其他已知的免疫治疗相关生物标志物(包括药物靶标)来测量性能。为此，我们使用了四个免疫治疗队列——两个黑色素瘤队列，一个转移性胃癌队列(Kim等。29)和一个膀胱癌队列(IMvigor210)。</li>
<li>基于网络的方法，将生物标志物扩展到药物靶点的网络邻居，提高了基于药物靶点表达水平的预测。</li>
<li>将NetBio的预测性能与之前确定的其他ci相关生物标志物进行了比较，发现在大多数情况下，我们的方法在所有四个癌症数据集上都更好</li>
<li>当使用更少的训练数据集训练ML模型时，NetBio的预测与其他生物标志物相似或更好。（蒙特卡洛交叉验证）</li>
</ol>
</li>
<li>使用基于netbio的ML进行跨研究预测可以在其他独立的黑色素瘤数据集中做出一致的预测<ol>
<li>使用NetBio训练的ML模型在使用独立数据集时可以做出稳健的预测，而使用其他生物标志物时预测性能较差</li>
<li>当三个独立的训练数据集合并到单个数据集时，基于netbio的预测效果优于其他方法</li>
<li>当训练数据和测试数据来自不同的队列时，NetBio提高了预测性能。（三个不同队列）</li>
<li>测试了ML模型是否能在训练样本较少的情况下做出稳健的预测。同样，与基于GeneBio或基于tme - bio的ML模型相比，样本量较小的NetBio-based ML做出了一致的预测。</li>
</ol>
</li>
<li>将基于netbio的预测与其他先进的免疫治疗反应预测方法以及基于深度神经网络(DNN)的方法进行了比较34(参见方法)，优于</li>
<li>基于netbio的预测优于纯数据驱动的特征选择方法。对新数据集的适应性和预测的准确性，加入PPI网络后优于传统方法</li>
<li>基于netbio的预测再现了外部癌症基因组图谱(TCGA)数据集中的免疫微环境。<ol>
<li>进一步研究了哪些NetBio通路与免疫细胞比例高度相关</li>
<li>用NetBio通路可以捕获胃癌和膀胱癌的免疫微环境。</li>
</ol>
</li>
<li>NetBio通路表达水平与膀胱癌患者的免疫细胞浸润有关。<ol>
<li>使用了不同的免疫表型，包括(i)免疫沙漠(少于10个CD8 T细胞)，(ii)排除(CD8 T细胞毗邻肿瘤细胞)，和(iii)浸润(CD8 T细胞接触肿瘤细胞)表型30，并比较了趋化和吞噬途径的表达水平与免疫表型，与免疫荒漠或排除表型相比，免疫浸润表型表现出最高的通路表达水平(Mann-Whitney U P &lt; 0.05)，提示NetBio通路可捕获膀胱癌白细胞浸润分数。</li>
</ol>
</li>
<li>在ML模型中结合NetBio表达水平和肿瘤突变负担(TMB)可以提高PDL1抑制剂治疗膀胱癌患者的预测能力。<ol>
<li>结合NetBio表达水平和TMB改善了atezolizumab治疗膀胱癌患者的总生存预测</li>
<li>观察到联合预测因子使用TMB正确地将无应答者从预测应答者中重新分类(R2NR;)，并正确地将有应答者与单独tmb预测的无应答者重新分类</li>
<li>在观察到改进的预测性能之后，我们试图确定一种对预测性能的改进负责的特征。</li>
<li>为了进一步研究Raf激活通路作为ici治疗的生物标志物的潜在作用，我们分析了PD-L1表达、TMB和Raf激活成分的表达水平与外部TCGA膀胱癌数据集总生存期之间的关联</li>
</ol>
</li>
</ol>
<h2 id="优点和借鉴"><a href="#优点和借鉴" class="headerlink" title="优点和借鉴"></a>优点和借鉴</h2><ol>
<li>基于netbio的ML表现出一致的预测性能，而基于GeneBio、tme - bio的预测或纯数据驱动方法识别的特征表现出较差的优化性能。</li>
<li>尽管使用较小的网络时ICI响应预测性能下降，但基于网络的方法仍然比基于目标基因和基于肿瘤微环境的生物标志物表现更好。(对比STRING &gt; 900 (NetBio 900)和使用STRING &gt; 700 (NetBio 700)发现的NetBio通路)</li>
<li>作为ICI靶点的网络邻居，NetBio通路可以从转录组数据中稳健地捕获患者的免疫组成。</li>
<li>将所有癌症类型合并到一个单一的综合数据集并不能提高ICI反应预测的性能，这表明癌症类型特异性ICI反应机制的重要性。ICI治疗反应的基于表达的生物标志物在不同的癌症类型中是不同的</li>
<li>整体参考其基于NetBio的ML方法在对ICI治疗效果的预测模型的开发过程，运用的方法以及最后的结果检验。</li>
</ol>
]]></content>
      <categories>
        <category>ML</category>
        <category>ICI</category>
        <category>immunity</category>
      </categories>
      <tags>
        <tag>ML</tag>
        <tag>ICI</tag>
        <tag>immunity</tag>
      </tags>
  </entry>
  <entry>
    <title>R_coding</title>
    <url>/2022/07/10/R-coding/</url>
    <content><![CDATA[<h2 id="R-命令"><a href="#R-命令" class="headerlink" title="R 命令"></a>R 命令</h2><h4 id="包的安装"><a href="#包的安装" class="headerlink" title="包的安装"></a>包的安装</h4><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">install.packages<span class="punctuation">(</span><span class="string">&quot;***&quot;</span><span class="punctuation">)</span></span><br><span class="line">install.packages <span class="punctuation">(</span><span class="string">&quot;ABC&quot;</span><span class="punctuation">,</span>repos<span class="operator">=</span><span class="string">&quot;http://mirror.bjtu.edu.cn/ &quot;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&#x27;SingleCellExperiment&#x27;</span><span class="punctuation">)</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;Japrin/sscClust&quot;</span><span class="punctuation">)</span></span><br><span class="line">.libPaths<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment">#包的位置</span></span><br><span class="line">installed.packages<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment">#查看你已经安装了哪些包。</span></span><br><span class="line">available.packages<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment">#可以查看自己的机器可以安装哪些包</span></span><br></pre></td></tr></table></figure>

<h3 id="保存"><a href="#保存" class="headerlink" title="保存"></a>保存<span id="more"></span></h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">save.image<span class="punctuation">(</span>file <span class="operator">=</span> <span class="string">&quot;test.RData&quot;</span><span class="punctuation">)</span>    <span class="comment">#保存当前所有变量</span></span><br><span class="line">save<span class="punctuation">(</span>mouse<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;test.RData&quot;</span><span class="punctuation">)</span>   <span class="comment">#保存其中一个变量</span></span><br><span class="line">load<span class="punctuation">(</span>mouse.RData<span class="punctuation">)</span>  <span class="comment">#使用时加载命令</span></span><br></pre></td></tr></table></figure>

<h3 id="提取指定亚群"><a href="#提取指定亚群" class="headerlink" title="提取指定亚群"></a>提取指定亚群</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">cd4_sce1 <span class="operator">=</span> sce<span class="punctuation">[</span><span class="punctuation">,</span>sce<span class="operator">@</span>meta.data<span class="operator">$</span>seurat_clusters <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">cd4_sce2 <span class="operator">=</span> sce<span class="punctuation">[</span><span class="punctuation">,</span> Idents<span class="punctuation">(</span>sce<span class="punctuation">)</span> <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span> <span class="string">&quot;Naive CD4 T&quot;</span> <span class="punctuation">,</span>  <span class="string">&quot;Memory CD4 T&quot;</span> <span class="punctuation">)</span><span class="punctuation">]</span> <span class="comment"># subset 函数也可以</span></span><br></pre></td></tr></table></figure>

<h3 id="Seurat-对象输出"><a href="#Seurat-对象输出" class="headerlink" title="Seurat 对象输出"></a>Seurat 对象输出</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>data.table<span class="punctuation">)</span></span><br><span class="line">y <span class="operator">=</span> GetAssayData<span class="punctuation">(</span>object <span class="operator">=</span> object<span class="punctuation">,</span> slot <span class="operator">=</span> <span class="string">&quot;scale.data&quot;</span><span class="punctuation">)</span></span><br><span class="line">data_to_write_out <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>y<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">fwrite<span class="punctuation">(</span>x <span class="operator">=</span> data_to_write_out<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;outfile.csv&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="write-table"><a href="#write-table" class="headerlink" title="write.table"></a>write.table</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Usage</span><br><span class="line">write.table<span class="punctuation">(</span>x<span class="punctuation">,</span> file <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> append <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot; &quot;</span><span class="punctuation">,</span></span><br><span class="line">            eol <span class="operator">=</span> <span class="string">&quot;\n&quot;</span><span class="punctuation">,</span> na <span class="operator">=</span> <span class="string">&quot;NA&quot;</span><span class="punctuation">,</span> dec <span class="operator">=</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">            col.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> qmethod <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;escape&quot;</span><span class="punctuation">,</span> <span class="string">&quot;double&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            fileEncoding <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line">write.csv<span class="punctuation">(</span>...<span class="punctuation">)</span></span><br><span class="line">write.csv2<span class="punctuation">(</span>...<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="两组差异基因的寻找"><a href="#两组差异基因的寻找" class="headerlink" title="两组差异基因的寻找"></a>两组差异基因的寻找</h3><p><a href="https://blog.csdn.net/FightingBob/article/details/104814298">https://blog.csdn.net/FightingBob/article/details/104814298</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>limma<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>edgeR<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>statmod<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">targets <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.csv<span class="punctuation">(</span><span class="string">&quot;F:/公众号/图文素材/运用limma对基因进行差异分析/limma_data.csv&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment">#行为细胞名，列为基因名</span></span><br><span class="line">group <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;C1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;C2&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">56</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">83</span><span class="punctuation">)</span> <span class="comment">#C1是未突变组，C2是突变组 C1=56 C1+C2=83</span></span><br><span class="line">dgelist <span class="operator">&lt;-</span> DGEList<span class="punctuation">(</span>counts <span class="operator">=</span> targets<span class="punctuation">,</span> group <span class="operator">=</span> group<span class="punctuation">)</span></span><br><span class="line">keep <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>cpm<span class="punctuation">(</span>dgelist<span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="number">1</span> <span class="punctuation">)</span> <span class="operator">&gt;=</span> <span class="number">2</span> <span class="comment">#过滤</span></span><br><span class="line">dgelist <span class="operator">&lt;-</span> dgelist<span class="punctuation">[</span>keep<span class="punctuation">,</span> <span class="punctuation">,</span>keep.lib.sizes <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">]</span></span><br><span class="line">dgelist_norm <span class="operator">&lt;-</span> calcNormFactors<span class="punctuation">(</span>dgelist<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;TMM&#x27;</span><span class="punctuation">)</span>  <span class="comment">#TMM标准化</span></span><br><span class="line">design <span class="operator">&lt;-</span> model.matrix<span class="punctuation">(</span><span class="operator">~</span>group<span class="punctuation">)</span>    <span class="comment">#构建分组矩阵</span></span><br><span class="line">dge <span class="operator">&lt;-</span> estimateDisp<span class="punctuation">(</span>dgelist_norm<span class="punctuation">,</span> design<span class="punctuation">,</span> robust <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="comment">#估算离散值</span></span><br><span class="line"><span class="comment">#差异分析</span></span><br><span class="line">fit <span class="operator">&lt;-</span> glmFit<span class="punctuation">(</span>dge<span class="punctuation">,</span> design<span class="punctuation">,</span> robust <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span>     <span class="comment">#拟合模型</span></span><br><span class="line">lrt <span class="operator">&lt;-</span> glmLRT<span class="punctuation">(</span>fit<span class="punctuation">)</span>   <span class="comment">#统计检验</span></span><br><span class="line">topTags<span class="punctuation">(</span>lrt<span class="punctuation">)</span></span><br><span class="line">write.csv<span class="punctuation">(</span>topTags<span class="punctuation">(</span>lrt<span class="punctuation">,</span> n <span class="operator">=</span> nrow<span class="punctuation">(</span>dgelist<span class="operator">$</span>counts<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27; F:/公众号/图文素材/运用limma对基因进行差异分析/glmLRT.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="comment">#输出主要结果</span></span><br></pre></td></tr></table></figure>

<h3 id="火山图"><a href="#火山图" class="headerlink" title="火山图"></a>火山图</h3><p><a href="https://blog.csdn.net/FightingBob/article/details/106161956">https://blog.csdn.net/FightingBob/article/details/106161956</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">diff_stat <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;F:/公众号/图文素材/绘制火山图&amp;热图/data.csv&quot;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">diff_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>diff_stat<span class="operator">$</span>FDR <span class="operator">&lt;</span> <span class="number">0.05</span> <span class="operator">&amp;</span> diff_stat<span class="operator">$</span>logFC <span class="operator">&gt;=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;diff&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;up&#x27;</span> <span class="comment">#上调趋势筛选</span></span><br><span class="line">diff_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>diff_stat<span class="operator">$</span>FDR <span class="operator">&lt;</span> <span class="number">0.05</span> <span class="operator">&amp;</span> diff_stat<span class="operator">$</span>logFC <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;diff&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;dowm&#x27;</span> <span class="comment">#下调趋势筛选</span></span><br><span class="line">diff_stat<span class="punctuation">[</span><span class="operator">!</span><span class="punctuation">(</span>diff_stat<span class="operator">$</span>diff <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;dowm&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;diff&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;no&#x27;</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>diff_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> logFC<span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span>FDR<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> diff<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;dowm&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Enriched OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Depleted OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;No diff OTUs&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;-log10 FDR p-value&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#meihua </span></span><br><span class="line">p1 <span class="operator">&lt;-</span> p1 <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span><span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.9</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="拟时轨迹-monocle2"><a href="#拟时轨迹-monocle2" class="headerlink" title="拟时轨迹 monocle2"></a>拟时轨迹 monocle2</h3><p><a href="https://www.jianshu.com/p/5d6fd4561bc0">https://www.jianshu.com/p/5d6fd4561bc0</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>monocle<span class="punctuation">)</span></span><br><span class="line">pbmc <span class="operator">&lt;-</span> readRDS<span class="punctuation">(</span><span class="string">&quot;pbmc.rds&quot;</span><span class="punctuation">)</span> <span class="comment">#导入注释好的seurat对象（已注释）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##提取表型信息--细胞信息(建议载入细胞的聚类或者细胞类型鉴定信息、实验条件等信息)</span></span><br><span class="line">expr_matrix <span class="operator">&lt;-</span> as<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>pbmc<span class="operator">@</span>assays<span class="operator">$</span>RNA<span class="operator">@</span>counts<span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;sparseMatrix&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">##提取表型信息到p_data(phenotype_data)里面 </span></span><br><span class="line">p_data <span class="operator">&lt;-</span> pbmc<span class="operator">@</span>meta.data </span><br><span class="line">p_data<span class="operator">$</span>celltype <span class="operator">&lt;-</span> pbmc<span class="operator">@</span>active.ident  <span class="comment">##整合每个细胞的细胞鉴定信息到p_data里面。如果已经添加则不必重复添加</span></span><br><span class="line"><span class="comment">##提取基因信息 如生物类型、gc含量等</span></span><br><span class="line">f_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>gene_short_name <span class="operator">=</span> row.names<span class="punctuation">(</span>pbmc<span class="punctuation">)</span><span class="punctuation">,</span>row.names <span class="operator">=</span> row.names<span class="punctuation">(</span>pbmc<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">##expr_matrix的行数与f_data的行数相同(gene number), expr_matrix的列数与p_data的行数相同(cell number)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建CDS对象</span></span><br><span class="line">pd <span class="operator">&lt;-</span> new<span class="punctuation">(</span><span class="string">&#x27;AnnotatedDataFrame&#x27;</span><span class="punctuation">,</span> data <span class="operator">=</span> p_data<span class="punctuation">)</span> </span><br><span class="line">fd <span class="operator">&lt;-</span> new<span class="punctuation">(</span><span class="string">&#x27;AnnotatedDataFrame&#x27;</span><span class="punctuation">,</span> data <span class="operator">=</span> f_data<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#将p_data和f_data从data.frame转换AnnotatedDataFrame对象。</span></span><br><span class="line">cds <span class="operator">&lt;-</span> newCellDataSet<span class="punctuation">(</span>expr_matrix<span class="punctuation">,</span></span><br><span class="line">                      phenoData <span class="operator">=</span> pd<span class="punctuation">,</span></span><br><span class="line">                      featureData <span class="operator">=</span> fd<span class="punctuation">,</span></span><br><span class="line">                      lowerDetectionLimit <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span></span><br><span class="line">                      expressionFamily <span class="operator">=</span> negbinomial.size<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#估计size factor和离散度</span></span><br><span class="line">cds <span class="operator">&lt;-</span> estimateSizeFactors<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line">cds <span class="operator">&lt;-</span> estimateDispersions<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#过滤低质量的细胞，若Seurat已经完成细胞过滤，此步可省略</span></span><br><span class="line"><span class="comment">#用表达某基因的细胞的数目对基因进行过滤</span></span><br><span class="line">cds <span class="operator">&lt;-</span> detectGenes<span class="punctuation">(</span>cds<span class="punctuation">,</span> min_expr <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span> <span class="comment">#这一操作会在fData(cds)中添加一列num_cells_expressed</span></span><br><span class="line">print<span class="punctuation">(</span>head<span class="punctuation">(</span>fData<span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#此时有13714个基因</span></span><br><span class="line">expressed_genes <span class="operator">&lt;-</span> row.names<span class="punctuation">(</span>subset<span class="punctuation">(</span>fData<span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    num_cells_expressed <span class="operator">&gt;=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment">#过滤掉在小于10个细胞中表达的基因，还剩11095个基因。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#轨迹定义基因选择及可视化和构建轨迹</span></span><br><span class="line"><span class="comment">##使用seurat选择的高变基因⚠️</span></span><br><span class="line">express_genes <span class="operator">&lt;-</span> VariableFeatures<span class="punctuation">(</span>pbmc<span class="punctuation">)</span></span><br><span class="line">cds <span class="operator">&lt;-</span> setOrderingFilter<span class="punctuation">(</span>cds<span class="punctuation">,</span> express_genes<span class="punctuation">)</span></span><br><span class="line">plot_ordering_genes<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line"><span class="comment">##使用clusters差异表达基因</span></span><br><span class="line">deg.cluster <span class="operator">&lt;-</span> FindAllMarkers<span class="punctuation">(</span>pbmc<span class="punctuation">)</span></span><br><span class="line">express_genes <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>deg.cluster<span class="punctuation">,</span>p_val_adj<span class="operator">&lt;</span><span class="number">0.05</span><span class="punctuation">)</span><span class="operator">$</span>gene</span><br><span class="line">cds <span class="operator">&lt;-</span> setOrderingFilter<span class="punctuation">(</span>cds<span class="punctuation">,</span> express_genes<span class="punctuation">)</span></span><br><span class="line">plot_ordering_genes<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line"><span class="comment">##使用monocle选择的高变基因⚠️</span></span><br><span class="line">disp_table <span class="operator">&lt;-</span> dispersionTable<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line">disp.genes <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>disp_table<span class="punctuation">,</span> mean_expression <span class="operator">&gt;=</span> <span class="number">0.1</span> <span class="operator">&amp;</span> dispersion_empirical <span class="operator">&gt;=</span> <span class="number">1</span> <span class="operator">*</span> dispersion_fit<span class="punctuation">)</span><span class="operator">$</span>gene_id</span><br><span class="line">cds <span class="operator">&lt;-</span> setOrderingFilter<span class="punctuation">(</span>cds<span class="punctuation">,</span> disp.genes<span class="punctuation">)</span></span><br><span class="line">plot_ordering_genes<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#这一步输入的expressed_genes来自于步骤4。</span></span><br><span class="line"><span class="comment">#⚠️⚠️后续分析使用的是该方法</span></span><br><span class="line"><span class="comment">#也可输入seurat筛选出的高变基因：expressed_genes &lt;- VariableFeatures(pbmc) </span></span><br><span class="line">diff <span class="operator">&lt;-</span> differentialGeneTest<span class="punctuation">(</span>cds<span class="punctuation">[</span>expressed_genes<span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>fullModelFormulaStr<span class="operator">=</span><span class="string">&quot;~cell_type&quot;</span><span class="punctuation">,</span>cores<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#~后面是表示对谁做差异分析的变量，理论上可以为p_data的任意列名</span></span><br><span class="line">head<span class="punctuation">(</span>diff<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##差异表达基因作为轨迹构建的基因,差异基因的选择标准是qval&lt;0.01,decreasing=F表示按数值增加排序</span></span><br><span class="line">deg <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>diff<span class="punctuation">,</span> qval <span class="operator">&lt;</span> <span class="number">0.01</span><span class="punctuation">)</span> <span class="comment">#选出2829个基因</span></span><br><span class="line">deg <span class="operator">&lt;-</span> deg<span class="punctuation">[</span>order<span class="punctuation">(</span>deg<span class="operator">$</span>qval<span class="punctuation">,</span>decreasing<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">head<span class="punctuation">(</span>deg<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##差异基因的结果文件保存</span></span><br><span class="line">write.table<span class="punctuation">(</span>deg<span class="punctuation">,</span>file<span class="operator">=</span><span class="string">&quot;train.monocle.DEG.xls&quot;</span><span class="punctuation">,</span>col.names<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>row.names<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">,</span><span class="built_in">quote</span><span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 轨迹构建基因可视化</span></span><br><span class="line">ordergene <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>deg<span class="punctuation">)</span> </span><br><span class="line">cds <span class="operator">&lt;-</span> setOrderingFilter<span class="punctuation">(</span>cds<span class="punctuation">,</span> ordergene<span class="punctuation">)</span>  </span><br><span class="line"><span class="comment">#这一步是很重要的，在我们得到想要的基因列表后，我们需要使用setOrderingFilter将它嵌入cds对象，后续的一系列操作都要依赖于这个list。</span></span><br><span class="line"><span class="comment">#setOrderingFilter之后，这些基因被储存在cds@featureData@data[[&quot;use_for_ordering&quot;]]，可以通过table(cds@featureData@data[[&quot;use_for_ordering&quot;]])查看</span></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&quot;train.ordergenes.pdf&quot;</span><span class="punctuation">)</span></span><br><span class="line">plot_ordering_genes<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#出的图黑色的点表示用来构建轨迹的差异基因，灰色表示背景基因。红色的线是根据第2步计算的基因表达大小和离散度分布的趋势(可以看到，找到的基因属于离散度比较高的基因)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#降维</span></span><br><span class="line">cds <span class="operator">&lt;-</span> reduceDimension<span class="punctuation">(</span>cds<span class="punctuation">,</span> max_components <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;DDRTree&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#Step 3: 拟时间轴轨迹构建和在拟时间内排列细胞</span></span><br><span class="line">cds <span class="operator">&lt;-</span> orderCells<span class="punctuation">(</span>cds<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#⚠️使用root_state参数可以设置拟时间轴的根，如下面的拟时间着色图中可以看出，左边是根。根据state图可以看出，根是State1，若要想把另一端设为根，可以按如下操作</span></span><br><span class="line">cds <span class="operator">&lt;-</span> orderCells<span class="punctuation">(</span>cds<span class="punctuation">,</span> root_state <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="comment">#把State5设成拟时间轴的起始点</span></span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">GM_state <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="keyword">if</span> <span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>unique<span class="punctuation">(</span>pData<span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="operator">$</span>State<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    T0_counts <span class="operator">&lt;-</span> table<span class="punctuation">(</span>pData<span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="operator">$</span>State<span class="punctuation">,</span> pData<span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="operator">$</span>seurat_clusters<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&quot;0&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="built_in">return</span><span class="punctuation">(</span><span class="built_in">as.numeric</span><span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">(</span>T0_counts<span class="punctuation">)</span><span class="punctuation">[</span>which</span><br><span class="line">                                       <span class="punctuation">(</span>T0_counts <span class="operator">==</span> <span class="built_in">max</span><span class="punctuation">(</span>T0_counts<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span> <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="built_in">return</span> <span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">cds <span class="operator">&lt;-</span> orderCells<span class="punctuation">(</span>cds<span class="punctuation">,</span> root_state <span class="operator">=</span> GM_state<span class="punctuation">(</span>cds<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#可视化</span></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&quot;cd8.pseudotime.pdf&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">7</span><span class="punctuation">)</span></span><br><span class="line">plot_cell_trajectory<span class="punctuation">(</span>cds<span class="punctuation">,</span> color_by<span class="operator">=</span><span class="string">&quot;Pseudotime&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> show_tree <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> show_backbone<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span> </span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&quot;cd8.state.pdf&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">7</span><span class="punctuation">)</span></span><br><span class="line">plot_cell_trajectory<span class="punctuation">(</span>cds<span class="punctuation">,</span> color_by<span class="operator">=</span><span class="string">&quot;State&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> show_tree <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> show_backbone<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span> </span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&quot;cd8.celltype.pdf&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">7</span><span class="punctuation">)</span></span><br><span class="line">plot_cell_trajectory<span class="punctuation">(</span>cds<span class="punctuation">,</span> color_by<span class="operator">=</span>Idents<span class="punctuation">(</span>cd8<span class="punctuation">)</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> show_tree <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> show_backbone<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span> </span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="颜色渐变"><a href="#颜色渐变" class="headerlink" title="颜色渐变"></a>颜色渐变</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">+</span>scale_color_gradientn<span class="punctuation">(</span>values <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span>ccolours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#330066&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#336699&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#66CC66&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#FFCC33&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span><span class="comment">#颜色渐变设置</span></span><br></pre></td></tr></table></figure>

<h3 id="excel不覆盖写入"><a href="#excel不覆盖写入" class="headerlink" title="excel不覆盖写入"></a>excel不覆盖写入</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">s<span class="comment">#前面讲过如何加载已有工作簿，这里以生成新excel工作簿为例，将数据写入文件中</span></span><br><span class="line">wb <span class="operator">&lt;-</span> xlsx<span class="operator">::</span>createWorkbook<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">sheets <span class="operator">&lt;-</span> getSheet<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 新生成的工作簿没有sheet，系统提示：Workbook has no sheets!</span></span><br><span class="line">sheet <span class="operator">&lt;-</span> createSheet<span class="punctuation">(</span>wb<span class="punctuation">,</span>sheetName <span class="operator">=</span> <span class="string">&quot;newSheet1&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#此时R内存中已经生成了一个工作簿，包含一个空的sheet工作表，通过addDataFrame()函数将数据写入sheet中.</span></span><br><span class="line"><span class="comment"># 用上面生成的datas数据框对象，取前4行数据写入当前sheet对象中</span></span><br><span class="line">addDataFrame<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>sheet<span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">saveWorkbook<span class="punctuation">(</span>wb<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;iris_new.xlsx&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#如果是在已有excel工作簿上操作，这里最好做一个判断，避免覆盖现有数据，造成不必要的麻烦。如果当前sheet的最后一行索引不等于零（说明有数据），则将新数据写到最后一行数据的下一行，同时不加入列名行(col.names = FALSE)；如果为零则将数据直接添加到sheet中。</span></span><br><span class="line"><span class="comment"># 用上面生成的datas数据框对象，取前4行数据写入当前sheet对象中</span></span><br><span class="line"><span class="keyword">if</span> <span class="punctuation">(</span>sheet<span class="operator">$</span>getLastRowNum<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">!=</span> <span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">         addDataFrame<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>sheet<span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>col.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>startRow <span class="operator">=</span> sheet<span class="operator">$</span>getLastRowNum<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">       <span class="punctuation">&#125;</span> <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">         addDataFrame<span class="punctuation">(</span>data<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>sheet<span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">       <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">saveWorkbook<span class="punctuation">(</span>wb<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;iris_new.xlsx&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="合并seurat对象"><a href="#合并seurat对象" class="headerlink" title="合并seurat对象"></a>合并seurat对象</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#两个对象</span></span><br><span class="line">pbmc.combined <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>pbmc4k<span class="punctuation">,</span> y <span class="operator">=</span> pbmc8k<span class="punctuation">,</span> add.cell.ids <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;4K&quot;</span><span class="punctuation">,</span> <span class="string">&quot;8K&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> project <span class="operator">=</span> <span class="string">&quot;PBMC12K&quot;</span><span class="punctuation">)</span></span><br><span class="line">pbmc.combined</span><br><span class="line"><span class="comment">#合并两个以上</span></span><br><span class="line">pbmc.big <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>pbmc3k<span class="punctuation">,</span> y <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>pbmc4k<span class="punctuation">,</span> pbmc8k<span class="punctuation">)</span><span class="punctuation">,</span> add.cell.ids <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;3K&quot;</span><span class="punctuation">,</span> <span class="string">&quot;4K&quot;</span><span class="punctuation">,</span> <span class="string">&quot;8K&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> project <span class="operator">=</span> <span class="string">&quot;PBMC15K&quot;</span><span class="punctuation">)</span></span><br><span class="line">pbmc.big</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>R_coding</category>
      </categories>
      <tags>
        <tag>R_coding</tag>
        <tag>Single_cell_analysis</tag>
      </tags>
  </entry>
  <entry>
    <title>Predictive Capability of Metabolic Panels for Postoperative Atrial Fibrillation in Cardiac Surgery Patients</title>
    <url>/2022/09/13/Predictive-Capability-of-Metabolic-Panels-for-Postoperative-Atrial-Fibrillation-in-Cardiac-Surgery-Patients/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/632068a316f2c2beb19f71b0.png"></p>
<p>论文链接：<a href="https://pubmed.ncbi.nlm.nih.gov/35636203/">https://pubmed.ncbi.nlm.nih.gov/35636203/</a></p>
<p>GitHub链接：</p>
<p>本地论文链接：<span id="more"></span></p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li>Postoperative atrial fibrillation (POAF) occurs in up to 65% of cardiac surgery patients and is associated with an increased risk for stroke and mortality. Electrolyte disturbances in sodium (Na+), potassium (K+), total calcium (Ca2+), chloride (Cl-), and magnesium (Mg2+) are predisposing factors for POAF, but these imbalances are yet to be used to predict POAF. The purpose of this study is to determine whether the development of POAF can be predicted by blood plasma ionic composition.</li>
<li>Neither of the two logistic regression nor two random forest models were able to effectively predict the development of POAF from plasma ionic concentrations, but the random forest models effectively classified patients who would not develop POAF.</li>
</ol>
<h2 id="Methods"><a href="#Methods" class="headerlink" title="Methods:"></a>Methods:</h2><p><img src="https://pic.imgdb.cn/item/63206a4b16f2c2beb1a1dbc1.png"></p>
<ol>
<li>AF was defined as per the Heart Rhythm Society definition as “any arrhythmia that has the ECG characteristics of AF and lasts sufficiently long for a 12-lead ECG to be recorded or at least 30 s on a rhythm strip”. 根据心脏节律协会的定义，房颤被定义为“任何具有房颤心电图特征的心律失常，且持续时间足够长，需要记录12导联心电图，或在节律条上至少持续30秒”。</li>
<li>进一步的描述性变量包括患者的体重指数(BMI)、吸烟状况、高血压&#x2F;糖尿病&#x2F;慢性肺病&#x2F;心肌梗死&#x2F;心力衰竭史和纽约心脏协会分级&#x2F;透析史，以及他们在入院时是否服用ACE抑制剂、β-受体阻滞剂或他汀类药物</li>
<li>根据数据建立了两个预测模型。第一项包括患者的性别、手术类型、年龄，以及五种离子术后的初始电解质值。第二组使用了性别、程序代码、年龄和一组8个回归系数。为了获得这些系数，使用五种离子中的每一种作为结果，并使用手术时间作为预测因子，对每个患者进行简单的线性模型拟合。每个模型返回两个系数，每个离子的斜率和截距。</li>
<li>选择逻辑回归和随机森林建模方法来检验POAF的预测因素。我们的第一组预测模型选择了逻辑回归。第二组选择随机森林进行分析。这两种模型都分析了患者性别、手术类型和年龄的影响。然后，我们将术后第一组实验室的离子值纳入两种模型，并将它们与每个离子的线性回归系数作为时间的函数并排进行比较。然后使用预测指标对这些模型进行评估，如曲线下面积(AUC)、灵敏度和特异性。</li>
</ol>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result:"></a>Result:</h2><p><img src="https://pic.imgdb.cn/item/63206b5416f2c2beb1a34e34.png"></p>
<p><img src="https://pic.imgdb.cn/item/63206b5d16f2c2beb1a3572d.png"></p>
<p><img src="https://pic.imgdb.cn/item/63206b6b16f2c2beb1a36b2a.png"></p>
<ol>
<li>手术类型、患者年龄、交叉夹夹时间、体外循环时间、吸烟状况、高血压史以及患者是否使用β -受体阻滞剂，在α &#x3D; 0.05时均有统计学意义。</li>
<li>生成受试者工作特征(ROC)曲线，以更好地可视化这些模型的强度。计算四种模型的曲线下面积(AUC)，见表3。线性回归系数的随机森林模型具有最大的AUC，尽管没有一个模型表现特别好，因为即使是最好的AUC也小于0.75。</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/63206c9716f2c2beb1a4efe9.png"></p>
<ol start="3">
<li>使用电解质数据，我们无法使用逻辑回归或随机森林预测模型有效预测POAF的发展。</li>
<li>我们的数据表明，术后初始BMP和术后期间电解质的变化率都不能有效预测POAF。这些结果表明这些电解质不是POAF的独立预测因子。相反，可能有一个或多个临床变量同时与电解质失衡和POAF的发展相关。</li>
<li>术后Na+和Cl-互相平行地变化。解释是血清Naþ和Cl?在术后设置是由生理盐水的量决定的，因为没有其他离子遵循类似的趋势。</li>
</ol>
<h2 id="优势和借鉴："><a href="#优势和借鉴：" class="headerlink" title="优势和借鉴："></a>优势和借鉴：</h2><ol>
<li>据我们所知，我们的研究是第一个将五种电生理相关离子结合在一起的研究。开阔思路，病人体内的离子水平在一定程度上可能和POAF有关系。</li>
<li>假阳性低，假阴性非常高，和我们目前在random forest预测上的结果以及逻辑回归模型上的预测结果一致，目前尚不清楚原因。会导致预测结果存在一定程度的误导和偏差。可能和数据集的不平均分布有一定的关系。</li>
<li>虽然我们的模型最终无法预测POAF的高风险患者，但它们明显表现出较高的特异性和阴性预测值，表明潜在人群患POAF的风险较低。</li>
</ol>
]]></content>
      <categories>
        <category>POAF</category>
      </categories>
      <tags>
        <tag>POAF</tag>
      </tags>
  </entry>
  <entry>
    <title>POAF</title>
    <url>/2022/07/31/POAF/</url>
    <content><![CDATA[<h2 id="Risk-factor-analysis-and-prediction-model-validation-of-atrial-fibrillation-after-esophageal-cancer-surgery"><a href="#Risk-factor-analysis-and-prediction-model-validation-of-atrial-fibrillation-after-esophageal-cancer-surgery" class="headerlink" title="Risk factor analysis and prediction model validation of atrial fibrillation after esophageal cancer surgery"></a><strong>Risk factor analysis and prediction model validation of atrial fibrillation after esophageal cancer surgery</strong></h2><p>性别：性别(1&#x3D;男，2&#x3D;女)</p>
<p>主任医师（1&#x3D;吴明，2&#x3D;范军强，3&#x3D;柴莹，4&#x3D;沈钢，5&#x3D;张赛，6&#x3D;赵百亲，7&#x3D;李星，8&#x3D;滕志华，9&#x3D;张国飞，10&#x3D;杨懋颖）</p>
<p>吸烟史、饮酒史、高血压、冠脉疾病、糖尿病：0无1有</p>
<p>术前新辅助治疗：1是0否</p>
<p>术前新辅助治疗是否为免疫：1是</p>
<p>术前心脏病史、术前心律失常病史、术前是否为窦性心律：0否1是</p>
<p>心超提示（0&#x3D;正常，1&#x3D;左房增大，2&#x3D;双房增大，3&#x3D;房间隔，4&#x3D;室间隔，5&#x3D;PCI术后，6&#x3D;左室增大，7&#x3D;心律失常，8&#x3D;二尖瓣关闭不全，9&#x3D;主动脉瓣关闭不全）</p>
<p>术中转开放（0&#x3D;胸部，1&#x3D;腹部，2&#x3D;都1，3&#x3D;本为开放手术，4&#x3D;0）5&#x3D;腹部腔镜胸部开放，6&#x3D;胸部腔镜腹部开放，40&#x3D;4+肺，30&#x3D;3+肺</p>
<p>吻合部位（1&#x3D;颈部，2&#x3D;胸部）</p>
<p>代食管物（1&#x3D;胃，2&#x3D;结肠，3&#x3D;空肠）</p>
<p>造瘘管（0&#x3D;0，1&#x3D;空肠造瘘，2&#x3D;鼻肠管）</p>
]]></content>
      <categories>
        <category>POAF_EC</category>
      </categories>
      <tags>
        <tag>POAF_EC</tag>
      </tags>
  </entry>
  <entry>
    <title>Spatially resolved proteomics via tissue expansion</title>
    <url>/2022/12/10/Spatially-resolved-proteomics-via-tissue-expansion/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/639461a8b1fccdcd36bc0e22.png"></p>
<p>论文链接：<a href="https://pubmed.ncbi.nlm.nih.gov/36450705/">https://pubmed.ncbi.nlm.nih.gov/36450705/</a></p>
<p>Github链接：<a href="https://github.com/lilulu777/ProteomEx">https://github.com/lilulu777/ProteomEx</a></p>
<p>本地链接：C:\Users\junglingfish\Zotero\storage\UH3XG72Q</p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li>描述了一种基于组织扩展和基于质谱的蛋白质组学相结合的空间分辨蛋白质组学方法，我们称之为扩展蛋白质组学(ProteomEx)。</li>
<li>提出了一种易于使用的手工组织显微解剖方法，结合自下而上的基于质谱的蛋白质组分析，以100 μ m横向分辨率和亚纳升体积精度评估组织中蛋白质组的空间变化率。</li>
<li>通过将组织嵌入可膨胀的水凝胶中，通过物理放大和染色来促进微观解剖，类似于膨胀显微镜中用于提高成像分辨率的概念。</li>
<li>还开发了从切除的组织-水凝胶复合材料中提取肽的后续程序，用于深入的基于质谱的DIA-MS蛋白质组学分析。</li>
<li>将组织扩张和显微解剖，随后是肽提取和ms - s分析的过程称为扩张蛋白质组学或ProteomEx。</li>
<li>ProteomEx能够定量分析哺乳动物组织中蛋白质组的空间变异性，横向分辨率为~160 μ m，相当于0.61 nL的组织体积，使用手动微采样，无需定制或特殊设备。</li>
<li>验证并证明了ProteomEx在生物组织(包括大脑、肝脏和乳腺癌)的精简大规模蛋白质组学分析中的实用性。</li>
<li>进一步应用ProteomEx在小鼠模型中通过对大脑亚区域的比较蛋白质组学分析来识别与阿尔茨海默病相关的蛋白质。</li>
</ol>
<h2 id="Method-amp-Result："><a href="#Method-amp-Result：" class="headerlink" title="Method &amp; Result："></a>Method &amp; Result：</h2><ol>
<li><p>ProteomEx Workflow development and optimization</p>
<p><img src="https://pic.imgdb.cn/item/63946586b1fccdcd36c1c18c.png"></p>
<ol>
<li>首先，用n -琥珀酰丙烯酸酯对化学固定的组织切片进行处理，将丙烯酰基团安装在蛋白质的伯胺基团上，从而使其通过酰胺基团可逆地锚定在聚合物网格上。</li>
<li>然后将处理过的样品嵌入到水凝胶中，优化后的水凝胶可以增加膨胀因子，并增强适合处理和手动采样完全膨胀的样品的机械性能。</li>
<li>对组织-水凝胶复合材料进行基于洗涤剂的处理以使其在机械上均匀，这允许所埋组织的各向同性膨胀和蛋白质在膨胀状态下的保留。</li>
<li>为了便于组织成像和人工显微解剖，样本用比色染料考马斯蓝染色，通过肉眼和简单的成像设置可以有效地显示扩张脑组织的形态细节。</li>
<li>可以对展开的样本进行成像(将蛋白质组图谱映射到组织形态上)，并以~100微米的精度手动解剖，以切除感兴趣的单个区域或将组织微采样到小体素中。使用优化的碱性缓冲液和胰蛋白酶凝胶消化从切除的组织-水凝胶切片中提取肽，然后进行LC-MS&#x2F;MS分析和数据处理。</li>
</ol>
</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/639466c0b1fccdcd36c35610.png"></p>
<ol start="2">
<li>ProteomEx validation and characterization<ol>
<li>ProteomEx涉及化学处理和组织扩张，因此对肽提取的效率进行量化，并验证该方法可实现的定性和定量重复性和敏感性是很重要的。<ol>
<li>以测得肽率和缺失解理率作为样品制备质量控制的主要参数，使用了成熟的溶液消化和压力循环技术(PCT)辅助组织消化方法进行基准测试。<ol>
<li>结论：ProteomEx和proExM-MS能够提高肽消化和提取的效率，与在溶液中和pct辅助的组织样品制备方法以及概念相似的proExM-MS相比，ProteomEx中使用的组织膨胀方案提供了更高的肽提取效率。</li>
</ol>
</li>
<li>使用timsTOF Pro质谱仪在数据依赖采集(DDA)模式下对提取的肽进行分析。<ol>
<li>ProteomEx可以获得高质量的蛋白质组，在蛋白质鉴定的数量和类型、翻译后修饰的回收率等方面与其他方法相当，满足蛋白质组学分析的需要。</li>
</ol>
</li>
<li>验证 ProteomEx 用比色染料对膨胀的组织进行染色，便于肉眼观察精细的形态特征，并通过手工显微解剖(精确到实际尺寸的~100微米)精确定位感兴趣的区域 的能力。——使用活检打孔器，提供高度可重复的微采样，取下3 mm直径的组织-水凝胶复合片(对应于膨胀前直径约500µm或5.9 nL组织体积，此处和整个区域的大小对应于扩张前的大小)和相邻的空白水凝胶片(用于控制可能在组织外扩散的肽)，并使用纯MS缓冲液作为阴性对照。<ol>
<li>与其他测试方法相比，ProtemoEx方法在大样本蛋白质定量方面具有相当的可重复性，而在微样本制备方面具有相似或略低的可重复性</li>
</ol>
</li>
<li>使用ProteomEx方法探索了组织微采样的体积依赖极限<ol>
<li>pct辅助样品制备是处理小样品的代表性方法，可以有效分析0.2-1 μ L范围内的组织体积，比ProteomEx高出约3个数量级。</li>
<li>ProteomEx为组织蛋白质组学分析提供了另一种策略，可在~100’s-µm横向分辨率下制备亚纳升体积的样品。</li>
</ol>
</li>
<li>为了评估ProteomEx对各种哺乳动物组织的适用性，我们在四种不同的小鼠组织类型上进行了ProteomEx，包括大脑、肝脏、乳腺癌和肺部。<ol>
<li>对于2.52 nL体积的免疫染色组织，我们在三个重复中鉴定出约7000个肽对应于约2000个蛋白质，证明了ProteomEx与免疫组化的兼容性</li>
<li>ProteomEx可以很容易地应用于不同的哺乳动物组织类型，并与抗体染色样品兼容。</li>
</ol>
</li>
<li>探索ProteomEx横向空间分辨率和组织体积的极限、<ol>
<li>平均而言，在PulseDIA模式下，我们在每个样品中鉴定并定量了超过3000个多肽和~1000个蛋白质</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>正常和致病脑组织的蛋白质组分析与亚区域精度<ol>
<li>应用该技术来表征患有和没有AD的小鼠大脑的蛋白质组学异质性<ol>
<li>我们使用了APP&#x2F; PS1 AD小鼠模型和两个年龄组的野生型(WT)小鼠，主要关注海马作为AD病理最主要的区域之一。</li>
<li>从每只小鼠大脑中，我们使用LEF为~6的ProteomEx解剖了皮层(V1)、海马区CA1 (CA1)、海马区CA3 (CA3)、齿状回(DG)和内侧膝关节复合体(MGC)的主要视觉区域(扩张前直径约330µm)。</li>
<li>在组织扩张后，使用2mm活检打孔器手动进行微采样，从而实现对亚区域的选择性和可重复的微解剖。</li>
</ol>
</li>
<li>所有122个样本在t分布随机邻居包埋(t-SNE)图中都能很好地按年龄(老&#x2F;年轻)进行分辨，但不同的基因型(AD&#x2F;WT)只能在老年小鼠中识别。——将重点放在老年组进行进一步的生物信息学分析。</li>
<li>在老年组中，AD小鼠大脑的蛋白质组学变化在不同区域或子区域之间有所不同。突触素结合蛋白2 (STXBP2)、载脂蛋白E (APOE)和Clusterin (CLU)在皮质和海马中重叠，而在MGC中不重叠。</li>
<li>海马蛋白组的分区域变化也显著，AD病变的变化并不是在整个海马中扩散，而是在海马体亚区、CA1和CA3的亚区域。证明了STXBP2的关键作用。结果表明ProteomEx工作流能够有效地研究AD的病理异质性。</li>
<li>进一步在空间蛋白质组学图中显示了STXBP2在每个冲孔中的蛋白表达。<ol>
<li>STXBP2在AD组几乎无表达，但在WT组高表达。</li>
<li>在WT组中，STXBP2在皮层V1和MGC中表达量较高，而在海马亚区表达量相对较低。</li>
</ol>
</li>
<li>由于老年AD小鼠CA1的改变最大，接下来我们重点研究CA1的通路和功能改变。<ol>
<li>Ingenuity Pathway Analysis, IPA和metscape数据库富集了192个DEPS。最重要的负通路是Rho家族GTPases的信号通路，它已被证明将细胞外信号转导到肌动蛋白细胞骨架，以改变轴突的生长和生长锥的运动性。</li>
<li>进一步探索生物过程和蛋白-蛋白相互作用，通过MCODE算法，显示了前三个显著富集的簇。</li>
<li>STXBP2和VAMP1作为海马区重叠蛋白，在轴突引导、神经系统发育和发育生物学中发挥着重要作用。</li>
</ol>
</li>
<li>通过比较同一组内海马三个亚区域的蛋白表达来探索海马的空间异质性。<ol>
<li>老年AD组(5个DEPs)的差异远低于其他三组(~40个DEPs)，说明空间异质性部分减弱。</li>
<li>计算了三个地区每两个样本之间的Pearson相关系数，并将结果显示在无监督的分层聚类热图中。——无论基因型或年龄，来自同一子区域的大多数样本都聚集在一起</li>
<li>DG样品蛋白表达水平一致性较高，各组间差异较小。</li>
<li>结果表明ProteomEx可以作为研究空间蛋白质组学的有力工具。</li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 id="优缺点以及借鉴价值："><a href="#优缺点以及借鉴价值：" class="headerlink" title="优缺点以及借鉴价值："></a>优缺点以及借鉴价值：</h2><ol>
<li>优点：<ol>
<li>简便易行：ProteomEx，包括组织扩张、可视化、显微解剖和肽提取，是强大的，廉价的，易于使用的，并可以很容易地部署在一个常规的实验室使用市售试剂和普通用品。</li>
<li>耗时相对短：从固定组织开始，总时间约58 h;然而，操作时间只有5小时，最长的步骤，包括组织扩张和凝胶内消化，可以同时对多个样品进行。</li>
<li>使用ProteomEx进行蛋白质分析的深度仅比使用常用的大块组织制备方法低约10%，尽管它不会导致包括生物标记物在内的重要生物学信息的大量损失，并且具有几乎相同的亚细胞定位分布。</li>
<li>可以有效且可重复地实现约160µm的横向分辨率；与基于液体萃取表面分析(LESA)的其他微采样方法相比，提供了至少高出两倍的横向分辨率；</li>
<li>与nanoPOTs技术相比，ProteomEx在约1nl体积的组织中产生了相似数量的蛋白质鉴定，尽管亚纳升体积的蛋白质分析深度较低；</li>
</ol>
</li>
</ol>
]]></content>
      <tags>
        <tag>Proteomics</tag>
      </tags>
  </entry>
  <entry>
    <title>Prediction of lymph node metastases using pre- treatment PET radiomics of the primary tumour in esophageal adenocarcinoma: an external validation study</title>
    <url>/2022/09/24/Prediction-of-lymph-node-metastases-using-pre-treatment-PET-radiomics-of-the-primary-tumour-in-esophageal-adenocarcinoma-an-external-validation-study/</url>
    <content><![CDATA[<p><img src="https://pic.imgdb.cn/item/632ef4b516f2c2beb125f0b1.png"></p>
<p>论文链接： <a href="https://pubmed.ncbi.nlm.nih.gov/33264032/">https://pubmed.ncbi.nlm.nih.gov/33264032/</a></p>
<p>GitHub链接：</p>
<p>本地链接：<span id="more"></span></p>
<h2 id="Summary："><a href="#Summary：" class="headerlink" title="Summary："></a>Summary：</h2><ol>
<li>通过开发和外部验证三种预测模型，改善食管腺癌的临床淋巴结分期(cN-分期);一个只有临床变量，一个只有正电子发射断层扫描(PET)放射组学，以及一个临床和放射组学联合模型。</li>
<li>两组患者的淋巴结转移发生率均为58%。临床、放射组学和联合模型的曲线下面积在发展队列中为0.79、0.69和0.82，在外部验证队列中为0.65、0.63和0.69，具有良好的校准效果。开发队列和验证队列的当前cN-阶段曲线下面积分别为0.60和0.66。对于总生存率，临床和放射组学联合模型在外部验证队列中获得了最佳的识别性能(X2 &#x3D; 6.08, df &#x3D; 1, p &#x3D; 0.01)。</li>
<li>在发展队列中发现了改进的预测性能，但使用来自原发肿瘤的PET放射组学模型并没有在外部验证队列中完全复制。</li>
</ol>
<h2 id="Method："><a href="#Method：" class="headerlink" title="Method："></a>Method：</h2><p><a href="https://pic.imgdb.cn/item/632ef99416f2c2beb12be279.png"><img src="https://pic.imgdb.cn/item/632ef99416f2c2beb12be279.png"></a></p>
<ol>
<li>为了减少观察者间的差异性，使用“ Automatic Decision Tree Learning Algorithm for Advanced Segmentation 高级分割自动决策树学习算法”(ATLAAS)在PET图像上系统地勾画食道原发性肿瘤总体积(gtv)。【Matlab】</li>
</ol>
<p><img src="https://pic.imgdb.cn/item/632ef97116f2c2beb12bb134.png"></p>
<ol start="2">
<li>特征提取和预测模型开发<ol>
<li>采用递归特征消除(RFE)和最小绝对收缩和选择算子(LASSO)方法选择最佳临床特征组合[从年龄、性别、肿瘤位置、组织细胞类型、临床T分期、新辅助治疗类型和肿瘤回归级别(标准评分)中选择]，使用受试者操作曲线(ROC)的AUC测量值。</li>
<li>计算放射组学特征的Pearson相关性，并将阈值设置为0.85。截断逻辑评估每个辐射组特征的平均绝对相关性，去掉平均绝对相关性最大的特征。</li>
<li>对被切除节点阳性(pN+)和阴性(pN0)结果之间的每个特征计算非参数Kolmogorov-Smirnov检验统计量，仅保留p值&lt; 0.05的特征，以确保两类显著区分。</li>
<li>最后，我们使用带有五倍交叉验证的射频识别算法来搜索频率非零的特征组合，并根据其AUC找到最优组合。</li>
<li>使用STAGE中所选特征的均值和标准差进行RFE前的特征值归一化。在STAGE队列中使用多变量逻辑回归建立预测模型，然后使用回归模型加权的系数计算每个患者的放射组学评分(Rad- score)。使用选定的临床变量和Rad-评分开发了一个联合模型。使用在STAGE中应用的相同数据转换执行CROSS中的外部验证。</li>
</ol>
</li>
<li>数据分析<ol>
<li>采用双侧t检验(连续变量)或Χ2&#x2F;fisher检验(分类变量)检验STAGE和CROSS之间的临床人口学差异。95%置信区间(95% ci)的估计来自2000个分层自举重复。使用校准图和Hosmer- Lemeshow检验统计量评估模型的适当校准。</li>
<li>通过将选择的临床变量和放射组学特征输入带有截尾的Cox比例风险模型，探索预后意义。我们计算了哈勒尔一致性指数，并对生存模型进行了显著性log- rank检验。为了确保高阶放射组学变量不仅仅是简单肿瘤特征的替代品，我们还将一致性指数和log- rank检验与原发性代谢肿瘤体积(MTV)和总病变糖酵解(TLG)进行了比较</li>
</ol>
</li>
</ol>
<h2 id="Result："><a href="#Result：" class="headerlink" title="Result："></a>Result：</h2><ol>
<li>临床数据部分：四个临床特征，采用优化AUC的RFE方法，将年龄、临床T分期、新辅助治疗和标准分级纳入多变量模型。该多变量临床模型的平均auc在STAGE为0.79 [95% CI(0.71-0.88)]，在CROSS为0.65 [95% CI(0.50-0.78)]。在同一队列中，基于cN的模型的平均aus分别为0.60 [95% CI(0.52-0.69)]和0.66 [95% C(0.55-0.78)]。</li>
<li>PET-CT部分：基于放射组学的模型选取了9个放射组学特征，STAGE组学的平均auc较低，为0.69 [95% CI (0.59 - 0.77)]， CROSS组学的平均auc为0.63 [95% CI(0.47-0.77)]。基于临床和放射组学的联合模型分别得出这些队列的平均auc为0.82 [95% CI(0.74-0.89)]和0.69 [95% CI 0.54 - 0.82]。</li>
</ol>
<h2 id="优点和借鉴："><a href="#优点和借鉴：" class="headerlink" title="优点和借鉴："></a>优点和借鉴：</h2><ol>
<li>开发了三个模型：使用临床变量，PET放射组学和临床放射组学模型，将临床数据和放射组学数据结合。</li>
<li>分为stage和cross两个队列，多中心采集数据，测试集和验证集有一定区分度。</li>
<li>临床-放射组学联合模型在外部队列的患者组间表现出良好的区分能力，但在发展队列中并非如此。</li>
<li>未能证明放射组学特征在预测食管腺癌LNMs方面明显优于cN分期或临床多变量模型。首先，临床PET图像的空间分辨率太大，无法进行放射学分析;其次，高阶放射学变量是简单MTV的替代品。</li>
<li>我们的结果增加了目前cN分期准确性仍然很差的证据。国际癌症控制联盟TNM的分类很大程度上依赖于解剖学定义CT对LNMs的敏感性低至18%，因为它依赖于形态学，不能区分隐匿性恶性转移和正常大小的淋巴结。</li>
<li>外部验证研究很少进行，特别是在放射组学领域。为了消除描述的观察者间可变性，我们使用一种标准化自动分割方法(ATLAAS)在PET图像上勾画肿瘤。也使用了标准化生物标志物(IBSI)。</li>
<li>主要限制是新辅助治疗后缺乏PET放射组学。</li>
<li>本研究无法评估淋巴结对PET新辅助治疗的反应，因此，基线放射学特征与术后最终病理淋巴结评价之间存在间接比较。</li>
</ol>
]]></content>
      <tags>
        <tag>EC</tag>
        <tag>PET</tag>
      </tags>
  </entry>
  <entry>
    <title>ask for data</title>
    <url>/2022/07/10/ask-for-data/</url>
    <content><![CDATA[<h1 id="ask-for-data"><a href="#ask-for-data" class="headerlink" title="ask for data"></a>ask for data</h1><p>Hi Professor xxx :</p>
<p>Thank you for reading!<br>I am a doctor in the Department of Thoracic Surgery of the Second Affiliated Hospital of Zhejiang University School of Medicine<br>My research is focused on xxx. I have recently read your paper: “ xxxxx”. The  work was so interesting and it was attractive to me.<br>I am wondering if you could kindly send me the source program, dataset and the necessary information about it. I promise they will be used only for research purposed.<br>      Thank you very much for your kind consideration and I am looking forward to your early reply.</p>
<p>All the best,</p>
]]></content>
  </entry>
</search>
